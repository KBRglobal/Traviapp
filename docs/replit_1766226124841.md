# Dubai Image Engine

## Overview

This is a Dubai travel tourism image generation and management system. The application uses Google's Gemini AI and OpenAI DALL-E to generate tourism-focused images for Dubai attractions, hotels, and experiences. It serves as a private "Freepik-style" image library specifically for Dubai travel content, with a Streamlit-based web interface for image generation and library management.

The system is designed to create SEO-optimized visual content for Dubai travel articles, with built-in keyword databases covering attractions, hotels, and tourist experiences.

## User Preferences

Preferred communication style: Simple, everyday language.

## Recent Changes (December 2024)

### New Super Features
- **Hebrew Caption Generator**: AI-powered Hebrew descriptions for each image using Gemini vision
- **Hebrew Search**: Search in Hebrew - auto-translates to English keywords
- **Collections System**: Create custom folders/collections and assign images to projects
- **ZIP Export**: Select multiple images and download as ZIP with metadata file
- **Comparison Mode**: Side-by-side image comparison with voting buttons
- **Auto AI Rating**: Function to score images 1-10 on import (ready for integration)

### Previous Updates
- **Enhanced Archive View**: Giant archive-style library with source attribution badges (Freepik/Gemini/OpenAI)
- **Like/Dislike System**: Like button saves preference, dislike button deletes image and prevents re-import
- **Freepik Priority**: Freepik images always shown first in library and search results
- **Source Tracking**: All images now track their source provider (Gemini AI, OpenAI, Freepik stock)
- **AI Quality Scores**: Images reviewed by AI agent display their quality score (1-10)
- **Duplicate Prevention**: Deleted Freepik images tracked to prevent re-downloading
- Added AI-powered visual research system that uses Gemini to research how places actually look before generating images
- Added Monster Mode for batch generation of 20-50 images with one click
- Added automatic SEO metadata generator (alt text, captions, keywords, schema markup)
- Added A/B Testing mode with multiple style variations (realistic, cinematic, editorial, architectural, vibrant)
- Added prompt history system to save and reuse successful prompts
- Added image rating system (good/bad/skip) for learning and quality tracking
- Implemented parallel generation with both Gemini and OpenAI providers
- Fixed collage issue by enforcing "single photograph" in all prompts

## System Architecture

### Frontend
- **Streamlit** - The entire UI is built using Streamlit, providing a web-based interface for image generation and library browsing
- The interface supports Hebrew language elements (RTL text) alongside English content
- 12 main tabs: Archive Library, Autopilot, Statistics, Manual Creation, Article Analysis, Monster Mode, Topic Editor, Freepik Import, AI Quality Agent, Collections, Comparison, ZIP Export

### Backend
- **Python** - Single-file application architecture in `app.py`
- **Google Gemini AI** - Used for AI image generation and visual research via the `google-genai` client library
- **OpenAI DALL-E** - Secondary image generation provider for parallel generation and A/B testing
- API credentials are loaded from environment variables

### Data Storage
- **File-based JSON storage** - No database is used; all data persists as JSON files
- `data/library/` - Main storage directory for the image library
- `data/generated/` - Generated images organized by topic slug in subdirectories
- `index.json` - Tracks all images and statistics
- `queue_state.json` - Maintains generation queue state
- `manifest.json` - Tracks generated topics with metadata
- `prompt_history.json` - Saves successful prompts for reuse
- `image_ratings.json` - Stores image quality ratings (like/dislike)
- `freepik_downloads.json` - Tracks downloaded Freepik resources and deleted IDs
- `ai_reviews.json` - Stores AI quality agent reviews with scores and recommendations
- `collections.json` - User-created image collections/folders
- `hebrew_captions.json` - AI-generated Hebrew captions for images

### Keyword System
- **`keywords_database.py`** - Contains a comprehensive database of Dubai tourism keywords organized by category:
  - Attractions (Burj Khalifa, Dubai Mall, etc.)
  - Hotels & Resorts
  - Experiences & Activities
- Each topic has associated keywords and priority levels for SEO optimization
- Helper functions for generating filenames and search tags

### Image Generation Flow
1. User selects a topic from the keyword database or enters custom keywords
2. System generates prompts with different image types (Hero, Interior, Activity, Detail, Practical views)
3. Gemini AI generates images based on the prompts
4. Images are saved with metadata JSON files in topic-specific directories
5. Manifest file is updated to track all generated content

### Image Types
The system generates 5 types of images per topic:
- Hero - External/exterior shots
- Interior/Experience views
- Activity/People shots
- Unique detail close-ups
- Practical informational views

## External Dependencies

### AI Services
- **Google Gemini AI** - Primary image generation service
  - Accessed via custom base URL (configurable for proxy/enterprise setups)
  - Requires `AI_INTEGRATIONS_GEMINI_API_KEY` environment variable
  - Requires `AI_INTEGRATIONS_GEMINI_BASE_URL` environment variable

### Python Packages
- `streamlit` - Web UI framework
- `google-genai` - Google's Generative AI client library
- Standard library: `os`, `base64`, `json`, `time`, `re`, `datetime`, `pathlib`

### Reference Materials
- Keyword research documents in `attached_assets/` for SEO strategy
- Image engine prompt templates for content optimization